{% extends "layout.html" %}
{% block body %}
<div class="row" ng-controller="AppController">
    <div class="stack-container">
        <div class="trash control text-center">
            <div class="btn-group">
                <div id="trash_expand_collapse_btn" class="btn btn-success"></div>
                <button class="btn btn-danger pop control">Pop</button>
                <div class="btn control clean trash btn-warning">Clean Trash<span class="glyphicon glyphicon-trash"></span></div>
            </div>
        </div>
        <div class="container">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1"></div>
            <div class="stack-ui-container stack-ui-top col-lg-10 col-md-10 col-sm-10 col-xs-10"></div>
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1"></div>
        </div>
        <div class="stack trash sortable">
        </div>
        <div class="container">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1"></div>
            <div id="content-input" class="col-lg-10 col-md-10 col-sm-10 col-xs-10">
                <div class="form">
                    <div class="input-group input-group-lg">
                        <span class="input-group-btn">
                            <button class="btn btn-success control append" ng-click="append()">Append</button>
                        </span>
                        <input type="text" placeholder="Todo descirption" name="item" class="form-control" id="control-todo-content" ng-keypress="content_keypress($event)">
                        <span class="input-group-btn">
                            <button class="btn btn-success control push" ng-click="push()">Push</button>
                        </span>
                    </div>
                </div>
            </div>
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1"></div>
        </div>
        <div class="stack sortable">
            <div ng-repeat="todo in stack | orderBy:'order' | reverse" class="todo container" data-todo-priority="{[ todo.priority ]}" data-todo-order="{[ todo.order ]}" data-todo-id="{[ todo.id ]}">
                <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
                    <span class="sort icon glyphicon glyphicon-sort pull-right"></span>
                </div>
                <div class="col-lg-10 col-md-10 col-sm-10 col-xs-10 stack-ui-container">
                    <span class="priority btn pull-left" ng-click="raisePriority(todo.id)">{[ todo.priority ]}</span>
                    <span class="content">{[ todo.content ]}</span>
                    <a ng-repeat="tag in todo.tags" class="badge" href="/tag/{[ tag ]}">{[ tag ]}</a>
                </div>
                <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1">
                    <span class="delete icon glyphicon glyphicon-remove-circle pull-left" ng-click="removeTodo(todo.id)"></span>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1"></div>
            <div class="stack-ui-container stack-ui-bottom col-lg-10 col-md-10 col-sm-10 col-xs-10"></div>
            <div class="col-lg-1 col-md-1 col-sm-1 col-xs-1"></div>
        </div>
    </div>
</div>
{% endblock %}
{% block extra_script %}
$(function() {
var controller = angular.element($("[ng-controller=AppController]")).scope();
{% for todo in stack %}
controller.push({{ todo|todo2json|safe }});
{% endfor %}

controller.$apply();
});
{% endblock %}
