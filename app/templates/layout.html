<!DOCTYPE html>
<html>
<head>
<title>Stack Todos</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

{% assets filters='cssmin', output='css/packed.css', 'css/bootstrap.min.css', 'css/style.css' %}
<link href="{{ ASSET_URL }}" rel="stylesheet" media="screen">
{% endassets %}
<!--[if lt IE 9]>
    <script src="{{ url_for('static', filename='js/html5shiv.js') }}"></script>
    <script src="{{ url_for('static', filename='js/respond.min.js') }}"></script>
    <![endif]-->
</head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <span class="navbar-brand">Stack Todos</span>
        </div>
        {% if g.user.is_authenticated() %}
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li>
                <a href="{{ url_for("logout") }}">Log out</a>
                </li>
            </ul>
            <form class="navbar-form navbar-right" role="search">
                <div class="form-group">
                    <input type="text" class="form-control stack_list_autocomplete" placeholder="find or create a stack">
                </div>
            </form>
        </div><!--/.navbar-collapse -->
        {% endif %}
    </div>
</div>
<div class="container">
    <div class="row">
        {% block body %}{% endblock %}
    </div>
</div>
{% assets filters='jsmin', output='js/packed.js', 'js/jquery.min.js', 'js/jquery-ui.min.js', 'js/bootstrap.min.js', 'js/underscore-min.js', 'js/stacktodos.js' %}
<script type="text/javascript" src="{{ ASSET_URL }}"></script>
{% endassets %}
</body>
<script>
$(".stack_list_autocomplete").autocomplete({
    source : function(request, response) {
        $.ajax({
            url : "/stack/list",
            data : {
                match : request.term
            },
            success : function(data) {
                data = JSON.parse(data);
                response($.map(data, function(item) {
                    return {
                        label : item,
                        value : item
                    };
            }));
            }
        });
    },
    minLength : 1,
    open : function() {
               $(this).removeClass("ui-corner-all").addClass("ui-corner-top");
           },
    close : function() {
                $(this).removeClass("ui-corner-top").addClass("ui-corner-all");
            },
    select : function (event, ui) {console.log(ui.label); window.location = "/stack/" + ui.label;}
});_
</script>
</html>
